<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Custom Wordle League</title>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; }
    .input-row, .guess-row {
      display: flex;
      justify-content: center;
      margin: 8px 0;
      gap: 8px; /* Add space between tiles */
    }
    .tile {
      width: 60px; height: 60px;
      border: 2px solid #999;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      font-weight: bold;
      text-transform: uppercase;
      border-radius: 4px;
    }
    .input-tile {
      background-color: #eee; /* Light background for input */
    }
    .green { background-color: #6aaa64; color: white; }
    .yellow { background-color: #c9b458; color: white; }
    .grey { background-color: #787c7e; color: white; }
    button { font-size: 20px; margin-top: 10px; }
    p { margin: 10px 0; }
  </style>
</head>
<body>
  <h1>Custom Wordle League</h1>
  <p>Type your 5-letter guess:</p>
  <div class="input-row" id="inputRow">
    <div class="tile input-tile" id="tile0"></div>
    <div class="tile input-tile" id="tile1"></div>
    <div class="tile input-tile" id="tile2"></div>
    <div class="tile input-tile" id="tile3"></div>
    <div class="tile input-tile" id="tile4"></div>
  </div>
  <button onclick="submitGuess()">Guess</button>
  <div id="result"></div>

  <input id="hiddenInput" style="opacity:0; position:absolute; top:-100px;">

  <script>
    window.onload = function() {
      document.getElementById('hiddenInput').focus();
    };

    document.getElementById('game').addEventListener('click', function() {
      document.getElementById('hiddenInput').focus();
    });
    const wordList = ["apple", "brave", "charm", "delta", "eagle", "fancy", "grape", "hound", "mango"];
    const startDate = new Date('2025-06-01');
    const today = new Date();
    const dayNumber = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
    const targetWord = wordList[dayNumber % wordList.length].toUpperCase();
    const maxGuesses = 6;
    const guesses = [];
    let currentGuess = "";

    const played = localStorage.getItem('wordlePlayed-' + dayNumber);
    const storedResult = localStorage.getItem('wordleResult-' + dayNumber);

    if (played) {
      document.querySelector('button').disabled = true;
      document.getElementById('result').innerHTML = '<p>‚úÖ You already played today!</p>' + storedResult;
    } else {
      document.addEventListener('keydown', handleKeyPress);
    }

    function handleKeyPress(e) {
      if (guesses.length >= maxGuesses) return;

      if (e.key === 'Backspace' && currentGuess.length > 0) {
        currentGuess = currentGuess.slice(0, -1);
      } else if (/^[a-zA-Z]$/.test(e.key) && currentGuess.length < 5) {
        currentGuess += e.key.toUpperCase();
      } else if (e.key === 'Enter') {
        submitGuess();
        return;
      }
      updateInputTiles();
    }

    function updateInputTiles() {
      for (let i = 0; i < 5; i++) {
        document.getElementById('tile' + i).textContent = currentGuess[i] || '';
      }
    }

    function submitGuess() {
      if (currentGuess.length !== 5) {
        alert('Enter a full 5-letter word.');
        return;
      }

      const guess = currentGuess;
      guesses.push(guess);
      const resultRow = getResultRow(guess);
      document.getElementById('result').appendChild(resultRow);

      if (guess === targetWord) {
        const msg = document.createElement('p');
        msg.textContent = 'üéâ You guessed it in ' + guesses.length + ' tries!';
        document.getElementById('result').appendChild(msg);
        endGame();
      } else if (guesses.length >= maxGuesses) {
        const msg = document.createElement('p');
        msg.textContent = '‚ùå Out of tries! The word was: ' + targetWord;
        document.getElementById('result').appendChild(msg);
        endGame();
      }

      currentGuess = '';
      updateInputTiles();
    }

    function getResultRow(guess) {
      const row = document.createElement('div');
      row.className = 'guess-row';

      const targetArr = targetWord.split('');
      const guessArr = guess.split('');
      const result = Array(5).fill('grey');

      const letterCounts = {};
      for (const letter of targetArr) {
        letterCounts[letter] = (letterCounts[letter] || 0) + 1;
      }

      // First pass: green
      for (let i = 0; i < 5; i++) {
        if (guessArr[i] === targetArr[i]) {
          result[i] = 'green';
          letterCounts[guessArr[i]]--;
          guessArr[i] = null;
          targetArr[i] = null;
        }
      }

      // Second pass: yellow
      for (let i = 0; i < 5; i++) {
        if (guessArr[i] && letterCounts[guessArr[i]] > 0) {
          result[i] = 'yellow';
          letterCounts[guessArr[i]]--;
        }
      }

      for (let i = 0; i < 5; i++) {
        const tile = document.createElement('div');
        tile.className = 'tile ' + result[i];
        tile.textContent = guess[i];
        row.appendChild(tile);
      }

      return row;
    }

  function endGame() {
    document.querySelector('button').disabled = true;
    document.removeEventListener('keydown', handleKeyPress);
    localStorage.setItem('wordlePlayed-' + dayNumber, 'true');
    localStorage.setItem('wordleResult-' + dayNumber, document.getElementById('result').innerHTML);
  }

</script>

<div style="position: fixed; top: 10px; right: 10px; font-size: 12px; color: #888;">
  v1.0.3
</div>
</body>
</html>