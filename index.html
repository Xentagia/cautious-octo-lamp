<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Custom Wordle League</title>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; }
    input { text-transform: uppercase; width: 120px; font-size: 24px; }
    button { font-size: 20px; margin-left: 10px; }
    .guess-row { display: flex; justify-content: center; margin: 5px 0; }
    .tile {
      width: 50px; height: 50px;
      border: 2px solid #999;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      text-transform: uppercase;
    }
    .green { background-color: #6aaa64; color: white; }
    .yellow { background-color: #c9b458; color: white; }
    .grey { background-color: #787c7e; color: white; }
    pre { background: #f0f0f0; padding: 10px; text-align: left; }
  </style>
</head>
<body>
  <h1>Custom Wordle League</h1>
  <p>Guess today's 5-letter word:</p>
  <input id="guess" maxlength="5">
  <button onclick="submitGuess()">Guess</button>
  <div id="result"></div>

  <script>
    const wordList = ["apple", "brave", "charm", "delta", "eagle", "fancy", "grape", "hound", "mango"];
    const startDate = new Date('2025-06-01');
    const today = new Date();
    const dayNumber = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
    const targetWord = wordList[dayNumber % wordList.length].toUpperCase();
    const maxGuesses = 6;
    const guesses = [];

    const played = localStorage.getItem('wordlePlayed-' + dayNumber);
    const storedResult = localStorage.getItem('wordleResult-' + dayNumber);

    if (played) {
      document.getElementById('guess').disabled = true;
      document.querySelector('button').disabled = true;
      document.getElementById('result').innerHTML = '<p>‚úÖ You already played today!</p>' + storedResult;
    }

    function submitGuess() {
      const input = document.getElementById('guess');
      const guess = input.value.toUpperCase();
      if (guess.length !== 5) {
        alert('Enter a 5-letter word.');
        return;
      }

      guesses.push(guess);
      const resultRow = getResultRow(guess);
      document.getElementById('result').appendChild(resultRow);

      if (guess === targetWord) {
        const msg = document.createElement('p');
        msg.textContent = 'üéâ You guessed it in ' + guesses.length + ' tries!';
        document.getElementById('result').appendChild(msg);
        endGame();
      } else if (guesses.length >= maxGuesses) {
        const msg = document.createElement('p');
        msg.textContent = '‚ùå Out of tries! The word was: ' + targetWord;
        document.getElementById('result').appendChild(msg);
        endGame();
      }

      input.value = '';
    }

    function getResultRow(guess) {
      const row = document.createElement('div');
      row.className = 'guess-row';

      const targetArr = targetWord.split('');
      const guessArr = guess.split('');
      const result = Array(5).fill('grey');

      const letterCounts = {};
      for (const letter of targetArr) {
        letterCounts[letter] = (letterCounts[letter] || 0) + 1;
      }

      // First pass: green
      for (let i = 0; i < 5; i++) {
        if (guessArr[i] === targetArr[i]) {
          result[i] = 'green';
          letterCounts[guessArr[i]]--;
          guessArr[i] = null; // Mark this as done
          targetArr[i] = null;
        }
      }

      // Second pass: yellow
      for (let i = 0; i < 5; i++) {
        if (guessArr[i] && letterCounts[guessArr[i]] > 0) {
          result[i] = 'yellow';
          letterCounts[guessArr[i]]--;
        }
      }

      // Build visual row
      for (let i = 0; i < 5; i++) {
        const tile = document.createElement('div');
        tile.className = 'tile ' + result[i];
        tile.textContent = guess[i];
        row.appendChild(tile);
      }

      return row;
    }

    function endGame() {
      document.getElementById('guess').disabled = true;
      document.querySelector('button').disabled = true;

      // Save result HTML for display on reload
      localStorage.setItem('wordlePlayed-' + dayNumber, 'true');
      localStorage.setItem('wordleResult-' + dayNumber, document.getElementById('result').innerHTML);
    }
  </script>
</body>
</html>
